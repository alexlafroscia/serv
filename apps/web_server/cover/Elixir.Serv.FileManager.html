<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>cover/Elixir.Serv.FileManager.html</title>
</head><body style='background-color: white; color: black'>
<pre>
File generated from /Users/alexlafroscia/Code/elixir/serv/apps/file_manager/lib/file_manager.ex by COVER 2017-04-13 at 23:49:46

****************************************************************************

        |  require Logger
        |  
        |  defmodule Serv.FileManager do
        |    @moduledoc """
        |    File Management Module
        |    """
        |  
        |    alias Serv.FileInstance
        |  
        |    @directory Application.get_env(:file_manager, :data_path)
        |  
        |    @doc """
        |    Returns a list of available file objects
        |    """
        |    def list do
     2..|      case File.ls(@directory) do
        |        {:ok, files} -&gt; files
     2..|          |&gt; Enum.map(fn(name) -&gt;
     4..|            {name, ext} = parse_filename(name)
     4..|            %Serv.File{name: name, extension: ext}
        |          end)
        |      end
        |    end
        |  
        |    @doc """
        |    Get a File by name
        |  
        |    ## Examples
        |  
        |      iex&gt; Serv.FileManager.get_file("fixture-a.txt")
        |      %Serv.File{
        |        name: "fixture-a",
        |        extension: "txt"
        |      }
        |  
        |      iex&gt; Serv.FileManager.get_file("some-invalid-file")
        |      nil
        |  
        |    """
        |    def get_file(name) do
     6..|      full_path = Path.join(@directory, name)
        |  
     6..|      case File.dir?(full_path) do
        |        true -&gt;
     3..|          {name, ext} = parse_filename(name)
     3..|          %Serv.File{name: name, extension: ext}
        |        false -&gt; nil
        |      end
        |    end
        |  
        |    @doc """
        |    Create a new file
        |  
        |    Given a file name and content, create a new file instance
        |    """
        |    def create_instance(file_name, file_content) when is_binary(file_name) do
     2..|      {name, ext} = parse_filename(file_name)
        |  
     2..|      file =
        |        case get_file(file_name) do
        |          nil -&gt;
     1..|            %Serv.File{name: name, extension: ext}
     1..|          found_file -&gt; found_file
        |        end
        |  
     2..|      create_instance(file, file_content)
        |    end
        |  
        |    def create_instance(file, file_content) do
     3..|      FileInstance.create(file, file_content)
        |    end
        |  
        |    defp parse_filename(path) do
     9..|      ext = Path.extname(path)
     9..|      basename = Path.basename(path, ext)
        |  
        |      {basename, String.slice(ext, 1..-1)}
        |    end
        |  end
</pre>
</body>
</html>
